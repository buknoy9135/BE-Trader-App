<div class="card p-5 mb-4">
  <h5 class="mb-3">Trader Transactions</h5>
  <div style="max-height: 75vh; overflow-y: auto;">
    <table class="table table-sm table-striped table-bordered border-secondary table-hover text-center mb-0">
      <thead class="table-dark" style="position: sticky; top: 0; z-index: 1;">
        <tr>
          <th style="width: 20%;">Trader</th>
          <th style="width: 7%;">Type</th>
          <th style="width: 9%;">Symbol</th>
          <th style="width: 12%;">Unit Price</th>
          <th style="width: 10%;">Quantity</th>
          <th style="width: 14%;">Total</th>
          <th style="width: 20%;">Date</th>
          <th style="width: 8%;">Action</th>
        </tr>
      </thead>
      <tbody class="table-group-divider">
        <% if @transactions.present? %>
          <% @transactions.each do |transaction| %>
            <tr>
              <td><%= "#{transaction.user.first_name} #{transaction.user.last_name}" %></td>
              <td>
                <% if transaction.transaction_type == "buy" %>
                  <span class="badge text-bg-success">Buy</span>
                <% else %>
                  <span class="badge text-bg-danger">Sell</span>
                <% end %>
              </td>
              <td><%= transaction.asset_symbol %></td>
              <td><%= number_to_currency(transaction.price) %></td>
              <td><%= transaction.quantity %></td>
              <td>
                <% sign = transaction.buy? ? "-" : "+" %>
                  <span class="<%= transaction.buy? ? 'text-danger' : 'text-success' %>">
                    <%= sign %><%= number_to_currency(transaction.total_amount) %>
                  </span>
              </td>
              <td><%= (transaction.executed_at || transaction.created_at)&.in_time_zone("Asia/Manila")&.strftime("%b %d, %Y") || "--" %></td>
              <td>
                <%= link_to 'View', admin_transaction_path(transaction), class: "btn btn-outline-secondary btn-sm" %>
              </td>
            </tr>
          <% end %>
        <% else %>
          <tr>
            <td colspan="8" class="text-muted">No transactions found.</td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>

<div class="d-flex justify-content-center mt-3">
  <%= paginate @transactions %>
</div>