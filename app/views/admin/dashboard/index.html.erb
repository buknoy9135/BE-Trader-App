<div class="mb-5">
  <h1 class="fw-bold mb-1">
    <i class="bi-clock-history me-2 text-danger"></i>
    Welcome back, <span class="text-primary"><%= current_user.first_name %></span>!
  </h1>
  <p class="text-muted">Here’s what’s happening today in your admin dashboard.</p>
</div>

<%# trader confirmation and approval requests %>
<div class="mb-4">
  <ul class="nav nav-tabs" id="traderTabs" role="tablist" data-turbo="false">
    <li class="nav-item" role="presentation">
      <button class="nav-link active" id="tab-one-tab" data-bs-toggle="tab" data-bs-target="#tab-one"
        type="button" role="tab" aria-controls="tab-one" aria-selected="true">
        <span class="mb-0 fw-bold fs-6">For Confirmation (<%= @pending_traders.count %>)</span>
      </button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link" id="tab-two-tab" data-bs-toggle="tab" data-bs-target="#tab-two"
        type="button" role="tab" aria-controls="tab-two" aria-selected="false">
        <span class="mb-0 fw-bold fs-6">For Approval (<%= @confirmed_traders.count %>)</span>
      </button>
    </li>
  </ul>
  
  <div class="tab-content border border-1 border-top-0 rounded-bottom p-4" id="myTabContent">
    <div class="tab-pane fade show active" id="tab-one" role="tabpanel" aria-labelledby="tab-one-tab">
      <%= render 'pending_confirmation_traders' %>
    </div>
    <div class="tab-pane fade" id="tab-two" role="tabpanel" aria-labelledby="tab-two-tab">
      <%= render 'pending_approval_traders' %>
    </div>
  </div>
</div>

<%# trader fund requests %>
<div class="card p-4 mb-4">
  <h6 class="mb-3">Trader Fund Requests (<%= @pending_funds&.count || 0 %>)</h6>
  <table class="table table-sm table-bordered border-secondary table-hover text-center">
    <thead class="table-dark">
      <tr>
        <th scope="col" style="width: 20%;">Requestor</th>
        <th scope="col" style="width: 12%;">Amount</th>
        <th scope="col" style="width: 10%;">Type</th>
        <th scope="col" style="width: 10%;">Status</th>
        <th scope="col" style="width: 14%;">Date Requested</th>
        <th scope="col" style="width: 14%;">Date Approved</th>
        <th scope="col" style="width: 20%;">Actions</th>
      </tr>
    </thead>
    <tbody class="table-group-divider">
      <% if @pending_funds.present? %>
        <% @pending_funds.each do |fund| %>
          <tr>
            <td><%= "#{fund.user.first_name} #{fund.user.last_name}" %></td>
            <td><%= number_to_currency(fund.amount) %></td>
            <td><%= fund.fund_type.capitalize %></td>
            <td><%= fund.status.capitalize %></td>
            <td>
              <%= fund.created_at&.in_time_zone("Asia/Manila")&.strftime("%b %d, %Y") %>
            </td>
            <td>
              <% if fund.approved? %>
                <%= fund.updated_at&.in_time_zone("Asia/Manila")&.strftime("%b %d, %Y") %>
              <% elsif fund.rejected? %>
                <span>--</span>
              <% else %>
                <span>Pending</span>
              <% end %>
            </td>
            <td>
              <div class="d-flex gap-1 justify-content-center">
                <%= link_to 'View', admin_fund_path(fund), class: "btn btn-outline-secondary btn-sm" %>
                <%= button_to 'Approve', approve_admin_fund_path(fund),
                  method: :patch,
                  data: { confirm: "Approve this request?" },
                  class: "btn btn-outline-success btn-sm" %>
                <%= button_to 'Reject', reject_admin_fund_path(fund),
                  method: :patch,
                  data: { confirm: "Reject this request?" },
                  class: "btn btn-outline-danger btn-sm" %>
              </div>
            </td>
          </tr>
        <% end %>
      <% else %>
        <tr>
          <td colspan="7">No pending fund request found.</td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>

<!--
<%# search bar %>
<div class="card px-3 mb-5">
  <h6 class="text-white p-2 rounded mt-4 bg-dark" >Search Stock Symbols</h6>
  
  <%= form_with url: admin_dashboard_path, method: :get, local: true do %>
    <div class="mb-3 d-flex gap-2">
      <%= text_field_tag :q, params[:q], placeholder: "e.g. Apple, Tesla", class: "form-control" %>
      <%= submit_tag "Search", class: "btn btn-primary btn-sm" %>
    </div>
  <% end %>
  
  <%# SEARCH MODAL %>
  <%= render 'search' %>
</div>
-->